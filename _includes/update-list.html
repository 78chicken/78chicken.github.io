{% assign MAX_SIZE = 5 %}

{% if site.posts.size > 0 %}
<section id="access-lastmod">
  <h2 class="panel-heading">{{- site.data.locales[include.lang].panel.lastmod -}}</h2>
  <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
    {% for post in site.posts limit: MAX_SIZE %}
    {% assign latest = post.updated | default: post.date %}
    <li class="text-truncate lh-lg">
      <a
        href="{{ post.url | relative_url }}"
        data-latest="{{ latest | date: '%Y-%m-%d' }}"
        class="post-link">
        {{ post.title }}
      </a>
    </li>
    {% endfor %}
  </ul>
</section>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    const links = document.querySelectorAll("#access-lastmod a[data-latest]");
    const today = new Date();

    links.forEach(link => {
      const dateStr = link.getAttribute("data-latest");
      const latestDate = new Date(dateStr);
      if (isNaN(latestDate)) return;

      const diffDays = Math.floor((today - latestDate) / (1000 * 60 * 60 * 24));

      if (diffDays <= 3) {
        link.classList.add("recent-update");
      } else if (diffDays <= 7) {
        link.classList.add("week-update");
      } else {
        link.classList.add("old-update");
      }
    });
  });
</script>
{% endif %}
